<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="W. David Walter">
<title>Manual-Applied-Spatial-Ecology - 27&nbsp; Dynamic Brownian Bridge Movement Models (dBBMM)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Landscape-Metrics.html" rel="next">
<link href="./MKDEcat_script.html" rel="prev">
<link href="./CoverSlide2.jpg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Home-Range-Estimation.html">Home Range Estimation</a></li><li class="breadcrumb-item"><a href="./CatdBBMM.html"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Dynamic Brownian Bridge Movement Models (dBBMM)</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Manual-Applied-Spatial-Ecology</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Manual of Applied Spatial Ecology</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Preface</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Data-Manipulation-Management.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Manipulation and Management</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MDprojections.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Transformations between coordinate systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TimeLagScript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Import and Format Datasets</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SoilScript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Manipulate Polygon Layer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./RasterScript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Manipulate Raster Data Layer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./GridScripts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Creating a Hexagonal Polygon Grid Over a Study Area</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./GridSystem2Script.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Creating a Square Polygon Grid Over a Study Area</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./BufferScript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Creating Buffers</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MidAtlantic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Mid-Atlantic layers using online sources</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Climate-Data-Interpretion.qmd</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ReadFilesScript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Climate Data Interpretation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Weather-Station-Code_Snowfall.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Using Data in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NetCDF_Script.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Importing Dynamically Downscaled Global Climate Data</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Movement-Methods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Movement Methods</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DMAdeerMovebank.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Movement Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MovementScript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Movement Trajectories</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DistanceUniqueBurst.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Distance Between Locations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FPTscript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">First Passage Time (FPT)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./RegTrajScript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Regular Trajectories</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NSDscript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Net Squared Displacement</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TrajDynScript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Movement Trajectory Animation</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Home-Range-Estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home Range Estimation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./HrefScript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Home Range Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./HlscvScript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Kernel Density Estimation (KDE) with least squares cross validation (lscv)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Panther_All4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">KDE with plug-in bandwidth selection (hplug-in)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./BBMMscript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Brownian Bridge Movement Models (BBMM)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MKDEcat_script.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Movement-based Kernel Density Estimation (MKDE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./CatdBBMM.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Dynamic Brownian Bridge Movement Models (dBBMM)</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Landscape-Metrics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Landscape Metrics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Frag_Auto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Landscape Metrics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PatchAnalystScript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Fragstats Metrics within Buffers</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Resource-Selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resource Selection</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MCPscript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Resource Selection</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./LinearDistScript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Preparing Linear Measures</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MD_DataPrep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Preparing Additional Covariates</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MuledeerSR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Selection Ratios</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./LogisticRSF.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Logistic Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NegBinomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Negative Binomial</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Dynamic Brownian Bridge Movement Models (dBBMM)</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>With the wide-spread use of GPS technology to track animals in near real time, estimators of home range and movement have developed concurrently. Unlike the traditional point-based estimators (i.e., MCP, KDE with href/hplug-in) that only incorporate density of locations into home range estimation, newer estimators incorporate more data provided by GPS technology. While BBMM incorporates a temporal component and GPS error into estimates, dynamic Brownian Bridge Movement Models (dBBMM) incorporate temporal and behavioral characteristics of movement paths into estimation of home range (Kranstauber et al.&nbsp;2012). Estimating a movement path over the entire trajectory of data, however, should be separated into behavorial movement patterns (i.e., resting, feeding) prior to estimating the variance of the Brownian motion. Overestimating the variance will cause an imprecision in estimation of the utilization distribution that dBBMM seeks to address (Kranstauber et al.&nbsp;2012).</p>
<p>1. Open the script “CatdBBMM.Rmd” and run code directly from the script</p>
<p>2. First we need to load the packages needed for the exercise</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">adehabitatLT</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">adehabitatHR</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://bartk.gitlab.io/move/">move</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>3. Now let’s have a separate section of code to include projection information we will use throughout the exercise. In previous versions, these lines of code were within each block of code</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ll.crs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="fl">4269</span><span class="op">)</span></span>
<span><span class="va">utm.crs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="fl">26917</span><span class="op">)</span></span>
<span><span class="va">albers.crs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="fl">5070</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>4. Read in panther dataset we have used previously</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Creates a Spatial Points Data Frame for 2 animals by ID</span></span>
<span><span class="va">panther</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data/pantherjitter.csv"</span>,header<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">panther</span><span class="op">$</span><span class="va">CatID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">panther</span><span class="op">$</span><span class="va">CatID</span><span class="op">)</span></span>
<span><span class="co">#To run BBMM we first need to use the original dataset to calculate time between locations</span></span>
<span><span class="va">panther</span><span class="op">$</span><span class="va">NewTime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_pad.html">str_pad</a></span><span class="op">(</span><span class="va">panther</span><span class="op">$</span><span class="va">TIMEET2</span>,<span class="fl">4</span>, pad<span class="op">=</span> <span class="st">"0"</span><span class="op">)</span></span>
<span><span class="va">panther</span><span class="op">$</span><span class="va">NewDate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">panther</span><span class="op">$</span><span class="va">DateET2</span>,<span class="va">panther</span><span class="op">$</span><span class="va">NewTime</span><span class="op">)</span></span>
<span><span class="co">#Used to sort data in code below for all deer</span></span>
<span><span class="va">panther</span><span class="op">$</span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strptime.html">strptime</a></span><span class="op">(</span><span class="va">panther</span><span class="op">$</span><span class="va">NewDate</span>, format<span class="op">=</span><span class="st">'%Y %m %d %H%M'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#Sort Data</span></span>
<span><span class="va">panther</span> <span class="op">&lt;-</span> <span class="va">panther</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">panther</span><span class="op">$</span><span class="va">CatID</span>, <span class="va">panther</span><span class="op">$</span><span class="va">DT</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="co">#TIME DIFF NECESSARY IN BBMM CODE</span></span>
<span><span class="va">timediff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">panther</span><span class="op">$</span><span class="va">DT</span><span class="op">)</span><span class="op">*</span><span class="fl">60</span></span>
<span><span class="co"># remove first entry without any difference </span></span>
<span><span class="va">panther</span> <span class="op">&lt;-</span> <span class="va">panther</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>,<span class="op">]</span> </span>
<span><span class="va">panther</span><span class="op">$</span><span class="va">timelag</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">timediff</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cat143</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">panther</span>, <span class="va">panther</span><span class="op">$</span><span class="va">CatID</span> <span class="op">==</span> <span class="st">"143"</span><span class="op">)</span></span>
<span><span class="va">cat143</span> <span class="op">&lt;-</span> <span class="va">cat143</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>,<span class="op">]</span> <span class="co">#Remove first record with wrong timelag</span></span>
<span><span class="va">cat143</span><span class="op">$</span><span class="va">CatID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html">droplevels</a></span><span class="op">(</span><span class="va">cat143</span><span class="op">$</span><span class="va">CatID</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Remove outlier locations</span></span>
<span><span class="va">coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span><span class="va">cat143</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="st">"Y"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="va">utm.crs</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">coords</span><span class="op">)</span>,axes<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="CatdBBMM_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cat.albers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">coords</span>, <span class="va">albers.crs</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>7. Create a move object for all deer using the Move package</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Create an ltraj trajectory object. </span></span>
<span><span class="va">ltraj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adehabitatLT/man/as.ltraj.html">as.ltraj</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">coords</span><span class="op">)</span>, <span class="va">coords</span><span class="op">$</span><span class="va">DT</span>, id <span class="op">=</span> <span class="va">coords</span><span class="op">$</span><span class="va">Sex</span>, burst <span class="op">=</span> <span class="va">coords</span><span class="op">$</span><span class="va">Sex</span>, </span>
<span>  typeII <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">loc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://bartk.gitlab.io/move/reference/move.html">move</a></span><span class="op">(</span><span class="va">ltraj</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>8. Now create a dBBMM object</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cat_dbbmm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://bartk.gitlab.io/move/reference/brownian.bridge.dyn.html">brownian.bridge.dyn</a></span><span class="op">(</span>object<span class="op">=</span><span class="va">loc</span>, location.error<span class="op">=</span><span class="fl">34</span>, window.size<span class="op">=</span><span class="fl">19</span>, margin<span class="op">=</span><span class="fl">7</span>,</span>
<span>dimSize<span class="op">=</span><span class="fl">500</span>,time.step<span class="op">=</span><span class="fl">180</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">cat_dbbmm</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>9. We can then explore the isopleth sizes and manipulate package move output to plot isopleths like previous exercises and write them out as shapefiles if needed</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/contour.html">contour</a></span><span class="op">(</span><span class="va">cat_dbbmm</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="fl">.9</span>,<span class="fl">.95</span>,<span class="fl">.99</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/methods/show.html">show</a></span><span class="op">(</span><span class="va">cat_dbbmm</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Plot the movement of the animal</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">loc</span>, type<span class="op">=</span><span class="st">"o"</span>, col<span class="op">=</span><span class="fl">3</span>, lwd<span class="op">=</span><span class="fl">2</span>, pch<span class="op">=</span><span class="fl">20</span>, xlab<span class="op">=</span><span class="st">"location_east"</span>,ylab<span class="op">=</span><span class="st">"location_north"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Code below will get area of each isopleth</span></span>
<span><span class="va">cat_cont</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://bartk.gitlab.io/move/reference/getVolumeUD.html">getVolumeUD</a></span><span class="op">(</span><span class="va">cat_dbbmm</span><span class="op">)</span></span>
<span><span class="va">cat_cont50</span> <span class="op">&lt;-</span> <span class="va">cat_cont</span><span class="op">&lt;=</span><span class="fl">.50</span></span>
<span><span class="va">cat_cont95</span> <span class="op">&lt;-</span> <span class="va">cat_cont</span><span class="op">&lt;=</span><span class="fl">.95</span></span>
<span><span class="va">area50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/values.html">values</a></span><span class="op">(</span><span class="va">cat_cont50</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">area50</span></span>
<span><span class="va">area95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/values.html">values</a></span><span class="op">(</span><span class="va">cat_cont95</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">area95</span></span>
<span></span>
<span><span class="co">##Cast the data over to an adehabitatHR estUD</span></span>
<span><span class="va">dbbmm.px</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html">as</a></span><span class="op">(</span><span class="va">cat_dbbmm</span>, <span class="st">"SpatialPixelsDataFrame"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html">image</a></span><span class="op">(</span><span class="va">dbbmm.px</span><span class="op">)</span></span>
<span><span class="va">dbbmm.ud</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/new.html">new</a></span><span class="op">(</span><span class="st">"estUD"</span>,<span class="va">dbbmm.px</span><span class="op">)</span></span>
<span><span class="va">dbbmm.ud</span><span class="op">@</span><span class="va">vol</span> <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="va">dbbmm.ud</span><span class="op">@</span><span class="va">h</span><span class="op">$</span><span class="va">meth</span> <span class="op">=</span> <span class="st">"dBBMM"</span></span>
<span></span>
<span><span class="va">shp99</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adehabitatHR/man/getverticeshr.html">getverticeshr</a></span><span class="op">(</span><span class="va">dbbmm.ud</span>, percent<span class="op">=</span><span class="fl">99</span>, standardize<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">shp99</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">map.ps99</span> <span class="op">&lt;-</span> <span class="fu">SpatialPolygons2PolySet</span><span class="op">(</span><span class="va">shp99</span><span class="op">)</span></span>
<span><span class="va">diss.map.99</span> <span class="op">&lt;-</span> <span class="fu">as.PolySet</span><span class="op">(</span><span class="va">map.ps99</span>, projection <span class="op">=</span> <span class="st">'UTM'</span>, zone <span class="op">=</span> <span class="st">'17'</span><span class="op">)</span></span>
<span><span class="va">diss.map.p99</span> <span class="op">&lt;-</span> <span class="fu">PolySet2SpatialPolygons</span><span class="op">(</span><span class="va">diss.map.99</span>, close_polys <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">data99</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>PID <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">diss.map.p99</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">SpatialPolygonsDataFrame</a></span><span class="op">(</span><span class="va">diss.map.p99</span>, data <span class="op">=</span> <span class="va">data99</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">diss.map.p99</span><span class="op">)</span></span>
<span><span class="co"># writeOGR(diss.map.p99, dsn = ".", layer="catcontour99", driver = "ESRI Shapefile")</span></span>
<span><span class="co"># catmap.99 &lt;- readOGR(dsn=".", layer="catcontour99")</span></span>
<span></span>
<span><span class="va">shp95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adehabitatHR/man/getverticeshr.html">getverticeshr</a></span><span class="op">(</span><span class="va">dbbmm.ud</span>, percent<span class="op">=</span><span class="fl">95</span>, standardize<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">shp95</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">map.ps95</span> <span class="op">&lt;-</span> <span class="fu">SpatialPolygons2PolySet</span><span class="op">(</span><span class="va">shp95</span><span class="op">)</span></span>
<span><span class="va">diss.map.95</span> <span class="op">&lt;-</span> <span class="fu">as.PolySet</span><span class="op">(</span><span class="va">map.ps95</span>, projection <span class="op">=</span> <span class="st">'UTM'</span>, zone <span class="op">=</span> <span class="st">'17'</span><span class="op">)</span></span>
<span><span class="va">diss.map.p95</span> <span class="op">&lt;-</span> <span class="fu">PolySet2SpatialPolygons</span><span class="op">(</span><span class="va">diss.map.95</span>, close_polys <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">data95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>PID <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">diss.map.p95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">SpatialPolygonsDataFrame</a></span><span class="op">(</span><span class="va">diss.map.p95</span>, data <span class="op">=</span> <span class="va">data95</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">diss.map.p95</span>, add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">#writeOGR(diss.map.p95, dsn = ".", layer="catcontour95", driver = "ESRI Shapefile")</span></span>
<span><span class="co">#catmap.95 &lt;- readOGR(dsn=".", layer="catcontour95")</span></span>
<span></span>
<span><span class="va">shp90</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adehabitatHR/man/getverticeshr.html">getverticeshr</a></span><span class="op">(</span><span class="va">dbbmm.ud</span>, percent<span class="op">=</span><span class="fl">90</span>, standardize<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">map.ps90</span> <span class="op">&lt;-</span> <span class="fu">SpatialPolygons2PolySet</span><span class="op">(</span><span class="va">shp90</span><span class="op">)</span></span>
<span><span class="va">diss.map.90</span> <span class="op">&lt;-</span> <span class="fu">as.PolySet</span><span class="op">(</span><span class="va">map.ps90</span>, projection <span class="op">=</span> <span class="st">'UTM'</span>, zone <span class="op">=</span> <span class="st">'17'</span><span class="op">)</span></span>
<span><span class="va">diss.map.p90</span> <span class="op">&lt;-</span> <span class="fu">PolySet2SpatialPolygons</span><span class="op">(</span><span class="va">diss.map.90</span>, close_polys <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">data90</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>PID <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">diss.map.p90</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">SpatialPolygonsDataFrame</a></span><span class="op">(</span><span class="va">diss.map.p90</span>, data <span class="op">=</span> <span class="va">data90</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">diss.map.p90</span>,add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="co"># writeOGR(diss.map.p90, dsn = ".", layer="catcontour90", driver = "ESRI Shapefile")</span></span>
<span><span class="co"># catmap.90 &lt;- readOGR(dsn=".", layer="catcontour90")</span></span>
<span></span>
<span><span class="va">shp80</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adehabitatHR/man/getverticeshr.html">getverticeshr</a></span><span class="op">(</span><span class="va">dbbmm.ud</span>, percent<span class="op">=</span><span class="fl">80</span>, standardize<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">map.ps80</span> <span class="op">&lt;-</span> <span class="fu">SpatialPolygons2PolySet</span><span class="op">(</span><span class="va">shp80</span><span class="op">)</span></span>
<span><span class="va">diss.map.80</span> <span class="op">&lt;-</span> <span class="fu">as.PolySet</span><span class="op">(</span><span class="va">map.ps80</span>, projection <span class="op">=</span> <span class="st">'UTM'</span>, zone <span class="op">=</span> <span class="st">'17'</span><span class="op">)</span></span>
<span><span class="va">diss.map.p80</span> <span class="op">&lt;-</span> <span class="fu">PolySet2SpatialPolygons</span><span class="op">(</span><span class="va">diss.map.80</span>, close_polys <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">data80</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>PID <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">diss.map.p80</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">SpatialPolygonsDataFrame</a></span><span class="op">(</span><span class="va">diss.map.p80</span>, data <span class="op">=</span> <span class="va">data80</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">diss.map.p80</span>,add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="co"># writeOGR(diss.map.p80, dsn = ".", layer="catcontour80", driver = "ESRI Shapefile")</span></span>
<span><span class="co"># catmap.80 &lt;- readOGR(dsn=".", layer="catcontour80")</span></span>
<span></span>
<span><span class="va">shp50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adehabitatHR/man/getverticeshr.html">getverticeshr</a></span><span class="op">(</span><span class="va">dbbmm.ud</span>, percent<span class="op">=</span><span class="fl">50</span>, standardize<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">map.ps50</span> <span class="op">&lt;-</span> <span class="fu">SpatialPolygons2PolySet</span><span class="op">(</span><span class="va">shp50</span><span class="op">)</span></span>
<span><span class="va">diss.map.50</span> <span class="op">&lt;-</span> <span class="fu">as.PolySet</span><span class="op">(</span><span class="va">map.ps50</span>, projection <span class="op">=</span> <span class="st">'UTM'</span>, zone <span class="op">=</span> <span class="st">'17'</span><span class="op">)</span></span>
<span><span class="va">diss.map.p50</span> <span class="op">&lt;-</span> <span class="fu">PolySet2SpatialPolygons</span><span class="op">(</span><span class="va">diss.map.50</span>, close_polys <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">data50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>PID <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">diss.map.p50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">SpatialPolygonsDataFrame</a></span><span class="op">(</span><span class="va">diss.map.p50</span>, data <span class="op">=</span> <span class="va">data50</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">diss.map.p50</span>,add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="co"># writeOGR(diss.map.p50, dsn = ".", layer="catcontour50", driver = "ESRI Shapefile")</span></span>
<span><span class="co"># catmap.50 &lt;- readOGR(dsn=".", layer="catcontour50")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>10. We can plot out the 50-99% isopleths to compare to previous estimators in size and shape around locations</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">diss.map.p99</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">diss.map.p95</span>, add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">diss.map.p90</span>,add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">diss.map.p80</span>,add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">diss.map.p50</span>,add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">coords</span><span class="op">)</span>,pch<span class="op">=</span><span class="fl">1</span>, cex<span class="op">=</span><span class="fl">0.5</span>,add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>11. Now we will shift towards polgyon-based estimators of home range to compare them to dBBMM. We will start with Characteristic Hull Polygons (CHP) in adehabitatHR package using the CharHull function.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">loc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"x"</span><span class="op">=</span><span class="va">cat143</span><span class="op">$</span><span class="va">X</span>,<span class="st">"y"</span><span class="op">=</span><span class="va">cat143</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span></span>
<span><span class="va">cats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPoints.html">SpatialPointsDataFrame</a></span><span class="op">(</span><span class="va">loc</span>,<span class="va">cat143</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/is.projected.html">proj4string</a></span><span class="op">(</span><span class="va">cats</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"+proj=utm +zone=17 +ellps=WGS84"</span></span>
<span></span>
<span><span class="co">#Home Range estimation</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adehabitatHR/man/CharHull.html">CharHull</a></span><span class="op">(</span><span class="va">cats</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="st">"res"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Computes the home range size for 20-100 percent</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/adehabitatHR/man/MCHu.html">MCHu2hrsize</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="CatdBBMM_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>            143
20     144.4545
30     340.6498
40     664.8405
50    1173.5487
60    1949.0595
70    3170.9746
80    5344.8134
90   10767.9219
100 103361.1336</code></pre>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#OR use</span></span>
<span></span>
<span><span class="va">res_ver99</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adehabitatHR/man/getverticeshr.html">getverticeshr</a></span><span class="op">(</span><span class="va">res</span>, percent<span class="op">=</span><span class="fl">99</span><span class="op">)</span></span>
<span><span class="va">res_ver95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adehabitatHR/man/getverticeshr.html">getverticeshr</a></span><span class="op">(</span><span class="va">res</span>, percent<span class="op">=</span><span class="fl">95</span><span class="op">)</span></span>
<span><span class="va">res_ver90</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adehabitatHR/man/getverticeshr.html">getverticeshr</a></span><span class="op">(</span><span class="va">res</span>, percent<span class="op">=</span><span class="fl">90</span><span class="op">)</span></span>
<span><span class="va">res_ver80</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adehabitatHR/man/getverticeshr.html">getverticeshr</a></span><span class="op">(</span><span class="va">res</span>, percent<span class="op">=</span><span class="fl">80</span><span class="op">)</span></span>
<span><span class="va">res_ver50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adehabitatHR/man/getverticeshr.html">getverticeshr</a></span><span class="op">(</span><span class="va">res</span>, percent<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">res_ver99</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">res_ver95</span>,add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">res_ver90</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">res_ver80</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">res_ver50</span>, add<span class="op">=</span><span class="cn">T</span>, col<span class="op">=</span><span class="st">"green"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">coords</span><span class="op">)</span>,pch<span class="op">=</span><span class="fl">1</span>, cex<span class="op">=</span><span class="fl">0.5</span>, add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="CatdBBMM_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>11. Next we will estimate home range with the Single-linkage Cluster (SLCA) using the clusthr function</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">uu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adehabitatHR/man/clusthr.html">clusthr</a></span><span class="op">(</span><span class="va">cats</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">uu</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MCHu"</code></pre>
</div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">uu_ver99</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adehabitatHR/man/getverticeshr.html">getverticeshr</a></span><span class="op">(</span><span class="va">uu</span>, percent<span class="op">=</span><span class="fl">99</span><span class="op">)</span></span>
<span><span class="va">uu_ver95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adehabitatHR/man/getverticeshr.html">getverticeshr</a></span><span class="op">(</span><span class="va">uu</span>, percent<span class="op">=</span><span class="fl">95</span><span class="op">)</span></span>
<span><span class="va">uu_ver90</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adehabitatHR/man/getverticeshr.html">getverticeshr</a></span><span class="op">(</span><span class="va">uu</span>, percent<span class="op">=</span><span class="fl">90</span><span class="op">)</span></span>
<span><span class="va">uu_ver80</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adehabitatHR/man/getverticeshr.html">getverticeshr</a></span><span class="op">(</span><span class="va">uu</span>, percent<span class="op">=</span><span class="fl">80</span><span class="op">)</span></span>
<span><span class="va">uu_ver50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adehabitatHR/man/getverticeshr.html">getverticeshr</a></span><span class="op">(</span><span class="va">uu</span>, percent<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">uu_ver99</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">uu_ver95</span>,add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">uu_ver90</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">uu_ver80</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">uu_ver50</span>, add<span class="op">=</span><span class="cn">T</span>, col<span class="op">=</span><span class="st">"green"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">coords</span><span class="op">)</span>,pch<span class="op">=</span><span class="fl">1</span>, cex<span class="op">=</span><span class="fl">0.5</span>, add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="CatdBBMM_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>12. Next we will explore Local Convex Hull (LoCoH)</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Exams the changes in home-range size for various values of k</span></span>
<span><span class="co">## Be patient! the algorithm can be very long</span></span>
<span><span class="co">#LoC.area &lt;- LoCoH.k.area(idsp, k=c(5:40))</span></span>
<span><span class="co">#NOTE: The line of code above does not run for this animal</span></span>
<span></span>
<span><span class="co">## the k-LoCoH method:</span></span>
<span><span class="va">nn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adehabitatHR/man/LoCoH.html">LoCoH.k</a></span><span class="op">(</span><span class="va">cats</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, k<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Graphical display of the results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">nn</span>, border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="CatdBBMM_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## the object nn is a list of objects of class</span></span>
<span></span>
<span><span class="co">#Save shapefiles of resulting home range</span></span>
<span><span class="va">ver</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adehabitatHR/man/getverticeshr.html">getverticeshr</a></span><span class="op">(</span><span class="va">nn</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#st_write(ver,dsn=".",layer="FixedK24.shp", driver = "ESRI Shapefile", overwrite=TRUE)</span></span>
<span><span class="va">nn_ver50</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/adehabitatHR/man/getverticeshr.html">getverticeshr</a></span><span class="op">(</span><span class="va">nn</span>, percent<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="co">#st_write(ver50,dsn=".",layer="50FixedK24", driver = "ESRI Shapefile",overwrite=TRUE)</span></span>
<span><span class="va">nn_ver80</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/adehabitatHR/man/getverticeshr.html">getverticeshr</a></span><span class="op">(</span><span class="va">nn</span>, percent<span class="op">=</span><span class="fl">80</span><span class="op">)</span></span>
<span><span class="co">#st_write(ver80,dsn=".",layer="80FixedK24", driver = "ESRI Shapefile",overwrite=TRUE)</span></span>
<span><span class="va">nn_ver90</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/adehabitatHR/man/getverticeshr.html">getverticeshr</a></span><span class="op">(</span><span class="va">nn</span>, percent<span class="op">=</span><span class="fl">90</span><span class="op">)</span></span>
<span><span class="co">#st_write(ver90,dsn=".",layer="90FixedK24", driver = "ESRI Shapefile",overwrite=TRUE)</span></span>
<span><span class="va">nn_ver95</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/adehabitatHR/man/getverticeshr.html">getverticeshr</a></span><span class="op">(</span><span class="va">nn</span>, percent<span class="op">=</span><span class="fl">95</span><span class="op">)</span></span>
<span><span class="co">#st_write(ver95,dsn=".",layer="95FixedK24", driver = "ESRI Shapefile",overwrite=TRUE)</span></span>
<span><span class="va">nn_ver99</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/adehabitatHR/man/getverticeshr.html">getverticeshr</a></span><span class="op">(</span><span class="va">nn</span>, percent<span class="op">=</span><span class="fl">99</span><span class="op">)</span></span>
<span><span class="co">#st_write(ver99,dsn=".",layer="99FixedK24", driver = "ESRI Shapefile",overwrite=TRUE)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">nn_ver99</span>,main<span class="op">=</span><span class="st">"Local Convex Hull"</span>,xlab<span class="op">=</span><span class="st">"X"</span>, ylab<span class="op">=</span><span class="st">"Y"</span>, font<span class="op">=</span><span class="fl">1</span>, cex<span class="op">=</span><span class="fl">0.8</span>, axes<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">nn_ver95</span>,add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">nn_ver90</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">nn_ver80</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">nn_ver50</span>, add<span class="op">=</span><span class="cn">T</span>, col<span class="op">=</span><span class="st">"green"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">coords</span><span class="op">)</span>,pch<span class="op">=</span><span class="fl">1</span>, cex<span class="op">=</span><span class="fl">0.5</span>, add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="CatdBBMM_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>13.&nbsp;We can add 4 estimators to the plot window to compare across estimators</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">diss.map.p99</span>,main<span class="op">=</span><span class="st">"dynamic BBMM"</span>,xlab<span class="op">=</span><span class="st">"X"</span>, ylab<span class="op">=</span><span class="st">"Y"</span>, font<span class="op">=</span><span class="fl">1</span>, cex<span class="op">=</span><span class="fl">0.8</span>, axes<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">diss.map.p95</span>, add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">diss.map.p90</span>,add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">diss.map.p80</span>,add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">diss.map.p50</span>,add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">coords</span><span class="op">)</span>,pch<span class="op">=</span><span class="fl">1</span>, cex<span class="op">=</span><span class="fl">0.5</span>, add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">res_ver99</span>,main<span class="op">=</span><span class="st">"Characteristic Hull Polygons"</span>,xlab<span class="op">=</span><span class="st">"X"</span>, ylab<span class="op">=</span><span class="st">"Y"</span>, font<span class="op">=</span><span class="fl">1</span>, cex<span class="op">=</span><span class="fl">0.8</span>, axes<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">res_ver95</span>,add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">res_ver90</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">res_ver80</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">res_ver50</span>, add<span class="op">=</span><span class="cn">T</span>, col<span class="op">=</span><span class="st">"green"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://bartk.gitlab.io/move/reference/points.html">points</a></span><span class="op">(</span><span class="va">loc</span>, pch<span class="op">=</span><span class="fl">1</span>, cex<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">coords</span><span class="op">)</span>,pch<span class="op">=</span><span class="fl">1</span>, cex<span class="op">=</span><span class="fl">0.5</span>, add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">uu_ver99</span>,main<span class="op">=</span><span class="st">"Single-linkage Cluster"</span>,xlab<span class="op">=</span><span class="st">"X"</span>, ylab<span class="op">=</span><span class="st">"Y"</span>, font<span class="op">=</span><span class="fl">1</span>, cex<span class="op">=</span><span class="fl">0.8</span>, axes<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">uu_ver95</span>,add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">uu_ver90</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">uu_ver80</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">uu_ver50</span>, add<span class="op">=</span><span class="cn">T</span>, col<span class="op">=</span><span class="st">"green"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">coords</span><span class="op">)</span>,pch<span class="op">=</span><span class="fl">1</span>, cex<span class="op">=</span><span class="fl">0.5</span>, add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">nn_ver99</span>,main<span class="op">=</span><span class="st">"Local Convex Hull"</span>,xlab<span class="op">=</span><span class="st">"X"</span>, ylab<span class="op">=</span><span class="st">"Y"</span>, font<span class="op">=</span><span class="fl">1</span>, cex<span class="op">=</span><span class="fl">0.8</span>, axes<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">nn_ver95</span>,add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">nn_ver90</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">nn_ver80</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">nn_ver50</span>, add<span class="op">=</span><span class="cn">T</span>, col<span class="op">=</span><span class="st">"green"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">coords</span><span class="op">)</span>,pch<span class="op">=</span><span class="fl">1</span>, cex<span class="op">=</span><span class="fl">0.5</span>, add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>



</main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./MKDEcat_script.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Movement-based Kernel Density Estimation (MKDE)</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Landscape-Metrics.html" class="pagination-link">
        <span class="nav-page-text">Landscape Metrics</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">R for Data Science (2e) was written by Hadley Wickham, Mine Çetinkaya-Rundel, and Garrett Grolemund.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


</body></html>