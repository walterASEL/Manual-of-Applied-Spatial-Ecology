<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="W. David Walter">
<title>Manual-Applied-Spatial-Ecology - 20&nbsp; Net Squared Displacement</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./TrajDynScript.html" rel="next">
<link href="./RegTrajScript.html" rel="prev">
<link href="./CoverSlide2.jpg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Movement-Methods.html">Movement Methods</a></li><li class="breadcrumb-item"><a href="./NSDscript.html"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Net Squared Displacement</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Manual-Applied-Spatial-Ecology</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/walterASEL/Manual-of-Applied-Spatial-Ecology" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Manual of Applied Spatial Ecology</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Preface</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Data-Manipulation-Management.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Manipulation and Management</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MDprojections.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Transformations between coordinate systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TimeLagScript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Import and Format Datasets</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SoilScript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Manipulate Polygon Layer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./RasterScript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Manipulate Raster Data Layer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./GridScripts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Creating a Hexagonal Polygon Grid Over a Study Area</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./GridSystem2Script.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Creating a Square Polygon Grid Over a Study Area</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./BufferScript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Creating Buffers</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MidAtlantic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Mid-Atlantic layers using online sources</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Climate-Data-Interpretion.qmd</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ReadFilesScript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Climate Data Interpretation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Weather-Station-Code_Snowfall.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Using Data in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NetCDF_Script.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Importing Dynamically Downscaled Global Climate Data</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Movement-Methods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Movement Methods</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DMAdeerMovebank.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Movement Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MovementScript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Movement Trajectories</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DistanceUniqueBurst.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Distance Between Locations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FPTscript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">First Passage Time (FPT)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./RegTrajScript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Regular Trajectories</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NSDscript.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Net Squared Displacement</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TrajDynScript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Movement Trajectory Animation</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Home-Range-Estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home Range Estimation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./HrefScript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Kernel Density Estimation (KDE) with reference bandwidth selection (href)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./HlscvScript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Kernel Density Estimation (KDE) with least squares cross validation (lscv)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Panther_All4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Kernel density estimators (KDE) with various bandwidth selection</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Panther_All4_amt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Kernel density estimators (KDE) with various bandwidth selection using package amt</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./BBMMscript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Brownian Bridge Movement Models (BBMM)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MKDEcat_script.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Movement-based Kernel Density Estimation (MKDE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./CatdBBMM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Dynamic Brownian Bridge Movement Models (dBBMM)</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Landscape-Metrics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Landscape Metrics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Frag_Auto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Landscape Metrics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PatchAnalystScript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Fragstats Metrics within Buffers</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Resource-Selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resource Selection</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MCPscript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Resource Selection</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./LinearDistScript.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Preparing Linear Measures</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MD_DataPrep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Preparing Additional Covariates</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MuledeerSR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Selection Ratios</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./LogisticRSF.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Logistic Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NegBinomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Negative Binomial</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Net Squared Displacement</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>Net squared displacement (NSD) looks at the movement vectors of animals to determine their use of the landscape (Bunnefeld et al.&nbsp;2011, Papworth et al.&nbsp;2012). Bunnefeld et al.&nbsp;(2011) determined a novel method to identify movement patterns using NSD which is the straight line distance between an animals’ starting location and subsequent locations. Movements were then categorized into one of 5 categories based on the top model that describes movement for each individual. In the code for this section, we have updated the code to include the 5 movement equations along with R code provided in Papworth et al.&nbsp;(2012) to enable determination of migratory, mixed migratory, disperser, home range, or nomadic movement behavior. Figure 1 in Bunnefeld et al.&nbsp;(2011) is helpful to interpret the output of this code that identifies the pattern of NSD over time that is determined by which of the 5 movement behaviors the animal follows. Those interested in this section should read the 2 papers cited for more details and specifics of the methods.</p>
<p>1. Open the script “NSDScript.Rmd” and run code directly from the script</p>
<p>2. First we need to load the packages needed for the exercise</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">adehabitatHR</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span><span class="co">#library(trip)</span></span>
<span><span class="co">#library(lattice)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>3. Now let’s have a separate section of code to include projection information we will use throughout the exercise. In previous versions, these lines of code were within each block of code</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ll.crs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="fl">4269</span><span class="op">)</span></span>
<span><span class="va">utm.crs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="fl">9001</span><span class="op">)</span></span>
<span><span class="va">albers.crs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="fl">5070</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>4. Going to be using previous mule deer dataset from Colorado and clean up the data as in previous exercises</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">muleys</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data/DCmuleysedited.csv"</span>, header<span class="op">=</span><span class="cn">T</span>, sep<span class="op">=</span><span class="st">","</span><span class="op">)</span></span>
<span></span>
<span><span class="va">muleys</span><span class="op">$</span><span class="va">NewDate</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="va">muleys</span><span class="op">$</span><span class="va">GPSFixTime</span>, format<span class="op">=</span><span class="st">"%Y.%m.%d %H:%M:%S"</span>, origin<span class="op">=</span><span class="st">"1970-01-01"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#TIME DIFF NECESSARY</span></span>
<span><span class="va">timediff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">muleys</span><span class="op">$</span><span class="va">NewDate</span><span class="op">)</span><span class="op">*</span><span class="fl">60</span></span>
<span><span class="co"># remove first entry without any difference </span></span>
<span><span class="va">muleys</span> <span class="op">&lt;-</span> <span class="va">muleys</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>,<span class="op">]</span> </span>
<span><span class="va">muleys</span><span class="op">$</span><span class="va">timediff</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">timediff</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">muleys</span><span class="op">$</span><span class="va">timediff</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
    3581    10792    10800    61399    10809 46399997 </code></pre>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Remove locations greater then 24 hours apart in time</span></span>
<span><span class="va">muleys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">muleys</span>, <span class="va">muleys</span><span class="op">$</span><span class="va">timediff</span> <span class="op">&lt;</span> <span class="fl">18000</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Remove outlier locations  then return to a dataframe to use later</span></span>
<span><span class="va">coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span><span class="va">muleys</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Long"</span>, <span class="st">"Lat"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="va">ll.crs</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">coords</span><span class="op">)</span>,axes<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="NSDscript_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">deer.spdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crop.html">st_crop</a></span><span class="op">(</span><span class="va">coords</span>, xmin<span class="op">=</span><span class="op">-</span><span class="fl">107.0</span>,xmax<span class="op">=</span><span class="op">-</span><span class="fl">110.5</span>,ymin<span class="op">=</span><span class="fl">37.8</span>,ymax<span class="op">=</span><span class="fl">39.0</span><span class="op">)</span><span class="co">#Visually identified based on previous plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">deer.spdf</span><span class="op">)</span>,axes<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="NSDscript_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">muleyscoords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">deer.spdf</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">muleyscoords</span><span class="op">$</span><span class="va">Lat</span> <span class="op">&lt;-</span> <span class="va">muleyscoords</span><span class="op">$</span><span class="va">X</span></span>
<span><span class="va">muleyscoords</span><span class="op">$</span><span class="va">Long</span> <span class="op">&lt;-</span> <span class="va">muleyscoords</span><span class="op">$</span><span class="va">Y</span></span>
<span></span>
<span><span class="va">muleys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">deer.spdf</span><span class="op">)</span></span>
<span><span class="va">muleys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_drop_geometry</a></span><span class="op">(</span><span class="va">muleys</span><span class="op">)</span>,<span class="va">muleyscoords</span><span class="op">)</span></span>
<span><span class="va">muleys</span> <span class="op">&lt;-</span> <span class="va">muleys</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">24</span><span class="op">:</span><span class="op">-</span><span class="fl">25</span><span class="op">)</span><span class="op">]</span><span class="co">#get rid of duplicate lat long as X and Y</span></span>
<span><span class="co">#Project deer.spdf to Albers as in previous exercise</span></span>
<span><span class="va">deer.albers</span> <span class="op">&lt;-</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">deer.spdf</span>, crs<span class="op">=</span><span class="va">albers.crs</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">deer.albers</span><span class="op">)</span>,axes<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="NSDscript_files/figure-html/unnamed-chunk-3-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>5. The key to NSD is proper delineation of movement periods so we can explore a few alternatives here. First we will define deer and year based simply on the Year the location was recorded. Not very biologically meaningful but for simplicity we will start with calender year. Be sure to skip step 6 below and continue on with step 7 to the end of the exercise.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">muleys</span><span class="op">$</span><span class="va">Year</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">muleys</span><span class="op">$</span><span class="va">NewDate</span>, <span class="st">"%Y"</span><span class="op">)</span></span>
<span><span class="va">muleys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">muleys</span>, <span class="va">muleys</span><span class="op">$</span><span class="va">Year</span> <span class="op">!=</span> <span class="st">"NA"</span><span class="op">)</span></span>
<span><span class="va">muleys</span><span class="op">$</span><span class="va">YearBurst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">muleys</span><span class="op">$</span><span class="va">id</span>,<span class="va">muleys</span><span class="op">$</span><span class="va">Year</span>,sep<span class="op">=</span><span class="st">"_"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">muleys</span><span class="op">$</span><span class="va">YearBurst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">muleys</span><span class="op">$</span><span class="va">YearBurst</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">muleys</span><span class="op">$</span><span class="va">NewDate</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>6. Alternatively, we could assign Year as when we would expect mule deer to disperse or migrate from summer to winter range. In our Colorado example, the mule deer were captured on 30 September 2011 (winter range) so we will start there and separate out a summer season from May to August using the code below. Be sure to skip step 5 above and run this step instead but do not run both.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">muleys</span><span class="op">$</span><span class="va">NewDate</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2011-10-12 00:00:34 EDT" "2012-08-31 09:00:51 EDT"</code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">muleys</span><span class="op">$</span><span class="va">Year2</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">muleys</span><span class="op">$</span><span class="va">Year2</span><span class="op">[</span><span class="va">muleys</span><span class="op">$</span><span class="va">NewDate</span> <span class="op">&gt;</span> <span class="st">"2011-09-30 00:30:00"</span> <span class="op">&amp;</span> </span>
<span>  <span class="va">muleys</span><span class="op">$</span><span class="va">NewDate</span> <span class="op">&lt;</span> <span class="st">"2012-03-31 23:00:00"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2011</span></span>
<span><span class="va">muleys</span><span class="op">$</span><span class="va">Year2</span><span class="op">[</span><span class="va">muleys</span><span class="op">$</span><span class="va">NewDate</span> <span class="op">&gt;</span> <span class="st">"2012-03-31 23:59:00"</span> <span class="op">&amp;</span></span>
<span>  <span class="va">muleys</span><span class="op">$</span><span class="va">NewDate</span> <span class="op">&lt;</span> <span class="st">"2012-10-01 23:00:00"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2012</span></span>
<span><span class="va">muleys</span><span class="op">$</span><span class="va">Year2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">muleys</span><span class="op">$</span><span class="va">Year2</span><span class="op">)</span></span>
<span><span class="va">muleys</span><span class="op">$</span><span class="va">YearBurst2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">muleys</span><span class="op">$</span><span class="va">id</span>,<span class="va">muleys</span><span class="op">$</span><span class="va">Year2</span>,sep<span class="op">=</span><span class="st">"_"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">muleys</span><span class="op">$</span><span class="va">YearBurst2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">muleys</span><span class="op">$</span><span class="va">YearBurst2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">muleys</span><span class="op">$</span><span class="va">YearBurst2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
D12_2011 D15_2011 D15_2012 D16_2011 D16_2012  D4_2011  D6_2011  D6_2012 
      98      619     1178     1048      739      102     1323       84 
 D8_2011 
     956 </code></pre>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#If needed we can remove deer that don't fit our minimum</span></span>
<span><span class="co">#sample size requirement</span></span>
<span><span class="va">muleys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">muleys</span>, <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">muleys</span><span class="op">$</span><span class="va">YearBurst2</span><span class="op">)</span><span class="op">[</span><span class="va">muleys</span><span class="op">$</span><span class="va">YearBurst2</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">muleys</span><span class="op">$</span><span class="va">YearBurst2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html">droplevels</a></span><span class="op">(</span><span class="va">muleys</span><span class="op">$</span><span class="va">YearBurst2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>7. Next we are going to rename our dataset to simply follow along with previous code I have created unless you want to change d1 to muleys throughout. This code will separate each deer by year which will make it easier to test NSD for each deer in our study</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">d1</span> <span class="op">&lt;-</span> <span class="va">muleys</span></span>
<span><span class="co">#Code separate each animal into a shapefile or text file to use as a "List" </span></span>
<span><span class="co">#Start with making an input file</span></span>
<span><span class="va">indata</span> <span class="op">&lt;-</span> <span class="va">d1</span></span>
<span><span class="va">innames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">d1</span><span class="op">$</span><span class="va">YearBurst2</span><span class="op">)</span></span>
<span><span class="va">innames</span> <span class="op">&lt;-</span> <span class="va">innames</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span><span class="co">#needs to be number of unique IDs</span></span>
<span><span class="va">outnames</span> <span class="op">&lt;-</span> <span class="va">innames</span></span>
<span><span class="co"># begin loop to calculate home ranges</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">innames</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="va">indata</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">indata</span><span class="op">$</span><span class="va">YearBurst2</span><span class="op">==</span><span class="va">innames</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,<span class="op">]</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="co">#data &lt;-data[c(-21)]</span></span>
<span>    <span class="co"># export the point data into a shp file</span></span>
<span>    <span class="va">data.xy</span> <span class="op">=</span> <span class="va">data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="st">"Y"</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/sp/man/coordinates.html">coordinates</a></span><span class="op">(</span><span class="va">data.xy</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="op">~</span><span class="va">X</span><span class="op">+</span><span class="va">Y</span></span>
<span>    <span class="va">sppt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPoints.html">SpatialPointsDataFrame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/coordinates.html">coordinates</a></span><span class="op">(</span><span class="va">data.xy</span><span class="op">)</span>,<span class="va">data</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/sp/man/is.projected.html">proj4string</a></span><span class="op">(</span><span class="va">sppt</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/CRS-class.html">CRS</a></span><span class="op">(</span><span class="va">utm.crs</span><span class="op">)</span></span>
<span>    <span class="co">#writePointsShape(sppt,fn=paste(outnames[i],sep="/"),factor2char=TRUE)</span></span>
<span>    <span class="co">#sppt &lt;-data[c(-22,-23)] </span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.table</a></span><span class="op">(</span><span class="va">sppt</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">outnames</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,<span class="st">"txt"</span>,sep<span class="op">=</span><span class="st">"."</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">"\t"</span>, quote<span class="op">=</span><span class="cn">FALSE</span>, row.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">outnames</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,<span class="st">"txt"</span>,sep<span class="op">=</span><span class="st">"."</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">"\t"</span>, quote<span class="op">=</span><span class="cn">FALSE</span>, row.names<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>      col.names<span class="op">=</span><span class="cn">FALSE</span>, <span class="st">"In_list.txt"</span>, append<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#The write.table line above should only be run once to create the In_list.txt file otherwise </span></span>
<span><span class="co">#it rights all animals each time</span></span>
<span>  </span>
<span><span class="co">#Note: There are 3 lines of code that are not active that can #be activated to export point </span></span>
<span><span class="co">#shapefiles for all resulting #animals but need to remove as.POSIX column first</span></span>
<span><span class="op">}</span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>10. Code below will be needed to get NSD and best movement model for each animal</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Reads the List file of GPS datasets</span></span>
<span><span class="va">List</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"In_list.txt"</span>,sep<span class="op">=</span><span class="st">"\t"</span>,header<span class="op">=</span><span class="cn">F</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span> <span class="co">#List contains the filenames of the all the datasets in our study </span></span>
<span><span class="co">#(i.e., By YearBurst we created previoulsy)</span></span>
<span></span>
<span><span class="co"># We will start by generating a vector of results we would like as the final</span></span>
<span><span class="co">#output to our analyses</span></span>
<span><span class="va">ID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">LOCS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">MIGR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">MIXM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">DISP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">HORA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">NOMA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">LOCS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">MIGR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">MIXM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">DISP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">HORA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">NOMA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">AICC_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">AICC_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">AICC_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">AICC_4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">AICC_5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">minAIC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">d_AICC_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">d_AICC_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">d_AICC_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">d_AICC_4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">d_AICC_5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">LL_AICC_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">LL_AICC_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">LL_AICC_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">LL_AICC_4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">LL_AICC_5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sumLL_AICC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">wi_AICC_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">wi_AICC_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">wi_AICC_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">wi_AICC_4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">wi_AICC_5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>11. The remainder of the code will be within a loop to run all animals in our dataset individually. The vector above will be populated with our results each time an animal has finished running through all the code</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">List</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> </span>
<span></span>
<span><span class="va">coords</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">List</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">)</span>,sep<span class="op">=</span><span class="st">"\t"</span>,header<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">coords</span><span class="op">$</span><span class="va">DT</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="va">coords</span><span class="op">$</span><span class="va">NewDate</span>, format<span class="op">=</span><span class="st">"%Y-%m-%d %H:%M:%S"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">##Make a data.frame of coordinates. Here the raw values are divided </span></span>
<span><span class="co">#by 1000 so that trajectories are calculated using km as the unit of measurement not meters</span></span>
<span><span class="va">coord</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">(</span><span class="va">coords</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span>,<span class="op">(</span><span class="va">coords</span><span class="op">$</span><span class="va">X</span><span class="op">)</span><span class="op">)</span>    </span>
<span><span class="co">#Make ltraj: a trajectory of all the relocations</span></span>
<span><span class="va">d2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/adehabitatLT/man/as.ltraj.html">as.ltraj</a></span><span class="op">(</span><span class="va">coord</span>,<span class="va">coords</span><span class="op">$</span><span class="va">DT</span>,</span>
<span><span class="va">coords</span><span class="op">$</span><span class="va">YearBurst2</span>,        <span class="co">#separate your data by individual.  </span></span>
<span>burst<span class="op">=</span><span class="va">coords</span><span class="op">$</span><span class="va">YearBurst2</span>, <span class="co">#burst is used to create subdivisions within an individual.</span></span>
<span>typeII<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>       </span>
<span></span>
<span><span class="co">#you can now make your trajectory regular </span></span>
<span><span class="co">#first, create a reference start time</span></span>
<span><span class="co">#refda &lt;- strptime("00:00", "%H:%M")   #all relocations should be altered </span></span>
<span><span class="co">#to occur at 30 seconds past each minute</span></span>
<span><span class="co">#firstly create a reference start time</span></span>
<span><span class="va">refda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strptime.html">strptime</a></span><span class="op">(</span><span class="st">"00:00:30"</span>, <span class="st">"%H:%M:%S"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#you can now make your trajectory regular, as radio tracks tend to lose </span></span>
<span><span class="co">#a few seconds / minutes with each relocation</span></span>
<span><span class="co">#firstly add "NA" for each missing location in your trajectory</span></span>
<span><span class="va">d3</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/adehabitatLT/man/setNA.html">setNA</a></span><span class="op">(</span><span class="va">d2</span>,<span class="va">refda</span>,</span>
<span><span class="co">#as.POSIXct("2007-06-01 06:00:00 EDT"), #any time before earliest timedate</span></span>
<span><span class="fl">10800</span>,            <span class="co">#stating there should be a location every 3 hours</span></span>
<span>tol<span class="op">=</span><span class="fl">10800</span>,        <span class="co">#how many time units to search each side of expected location</span></span>
<span>units<span class="op">=</span><span class="st">"sec"</span><span class="op">)</span>   <span class="co">#specifying the time units</span></span>
<span></span>
<span><span class="co">#you can now make your trajectory regular </span></span>
<span></span>
<span><span class="co">#NOTE: The refda and d3 code above was not run as in Papworth because </span></span>
<span><span class="co">#it results in too many relocations as "NA" that get removed below. Not </span></span>
<span><span class="co">#quite sure the reason behind it being included?</span></span>
<span></span>
<span><span class="co">#You can now make your trajectory regular </span></span>
<span><span class="va">d4</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/adehabitatLT/man/sett0.html">sett0</a></span><span class="op">(</span><span class="va">d3</span>, <span class="va">refda</span>, </span>
<span><span class="fl">10800</span>,                         <span class="co">#stating the interval at which relocations should be</span></span>
<span>correction.xy <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"none"</span><span class="op">)</span>,   <span class="co">#if "cs" performs location correction based on the </span></span>
<span><span class="co">#assumption the individual moves at a constant speed </span></span>
<span>tol<span class="op">=</span><span class="fl">10800</span>,       <span class="co">#how many time units to search either side of an expected location</span></span>
<span>units <span class="op">=</span> <span class="st">"sec"</span><span class="op">)</span>  <span class="co">#specifying the time units</span></span>
<span>                              </span>
<span><span class="co">#to view your regular trajectory of points with NA's</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">d4</span><span class="op">)</span></span>
<span><span class="co">#now calculating NSD for each point</span></span>
<span><span class="va">datansd</span><span class="op">&lt;-</span><span class="cn">NULL</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">n</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">d4</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="co">#stating that NSD should be </span></span>
<span><span class="co">#calculated separately for each burst</span></span>
<span><span class="op">{</span></span>
<span><span class="va">nsdall</span><span class="op">&lt;-</span><span class="va">d4</span><span class="op">[[</span><span class="va">n</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">8</span><span class="op">]</span>             <span class="co">#extracting the NSD for each location</span></span>
<span><span class="va">nsdtimeall</span><span class="op">&lt;-</span><span class="va">d4</span><span class="op">[[</span><span class="va">n</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>         <span class="co">#extracting the time for each location</span></span>
<span><span class="va">nsdtimestartzero</span><span class="op">&lt;-</span><span class="va">d4</span><span class="op">[[</span><span class="va">n</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">-</span><span class="va">d4</span><span class="op">[[</span><span class="va">n</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">]</span>  </span>
<span><span class="co">#extracting the time since trip start for each location</span></span>
<span><span class="va">nsdid</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">d4</span><span class="op">)</span><span class="op">[</span><span class="va">n</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>length.out<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">d4</span><span class="op">)</span><span class="op">[</span><span class="va">n</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span>     </span>
<span><span class="co">#extracting the individual associated with each location</span></span>
<span><span class="va">nsdtrip</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">d4</span><span class="op">)</span><span class="op">[</span><span class="va">n</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>,length.out<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">d4</span><span class="op">)</span><span class="op">[</span><span class="va">n</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#extracting the trip associated with each location</span></span>
<span><span class="va">datansd1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">nsdall</span>,<span class="va">nsdtimeall</span>,<span class="va">nsdtimestartzero</span>,<span class="va">nsdid</span>,<span class="va">nsdtrip</span><span class="op">)</span>                  </span>
<span><span class="co">#joining all these variables together in a data frame</span></span>
<span><span class="va">datansd</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">datansd</span>,<span class="va">datansd1</span><span class="op">)</span>                                                        </span>
<span><span class="co">#joining all the data frames together</span></span>
<span><span class="op">}</span></span>
<span><span class="va">datansd</span><span class="op">$</span><span class="va">zero1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html">unclass</a></span><span class="op">(</span><span class="va">datansd</span><span class="op">$</span><span class="va">nsdtimestartzero</span><span class="op">)</span><span class="op">)</span>                            </span>
<span><span class="co"># making seconds since trip start numeric</span></span>
<span><span class="va">datansd</span><span class="op">$</span><span class="va">zerostart</span><span class="op">&lt;-</span><span class="va">datansd</span><span class="op">$</span><span class="va">zero1</span><span class="op">/</span><span class="fl">60</span>                                                     </span>
<span><span class="co">#changing the time since trip start from seconds to minutes</span></span>
<span><span class="va">datansd</span><span class="op">$</span><span class="va">minslitr2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strptime.html">strftime</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXlt</a></span><span class="op">(</span><span class="va">datansd</span><span class="op">$</span><span class="va">nsdtimeall</span><span class="op">)</span>,</span>
<span>format<span class="op">=</span><span class="st">"%M"</span><span class="op">)</span><span class="op">)</span>     </span>
<span><span class="co">#making a vector of the hour of the day a location occured</span></span>
<span><span class="va">datansd</span><span class="op">$</span><span class="va">hdaylitr2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strptime.html">strftime</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXlt</a></span><span class="op">(</span><span class="va">datansd</span><span class="op">$</span><span class="va">nsdtimeall</span><span class="op">)</span>,</span>
<span>format<span class="op">=</span><span class="st">"%H"</span><span class="op">)</span><span class="op">)</span>     </span>
<span><span class="co">#making a vector of the minute in an hour a location occured</span></span>
<span><span class="va">datansd</span><span class="op">$</span><span class="va">minsday</span><span class="op">&lt;-</span><span class="op">(</span><span class="op">(</span><span class="va">datansd</span><span class="op">$</span><span class="va">hdaylitr2</span><span class="op">*</span><span class="fl">60</span><span class="op">)</span><span class="op">+</span><span class="va">datansd</span><span class="op">$</span><span class="va">minslitr2</span><span class="op">)</span>                             </span>
<span><span class="co">#calculating the minute in the day a location occured</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">datansd</span><span class="op">)</span></span>
<span><span class="va">datansd1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">datansd</span><span class="op">)</span>            <span class="co">#remove NA's</span></span>
<span></span>
<span><span class="va">datansd1</span><span class="op">$</span><span class="va">coordinates</span><span class="op">&lt;-</span><span class="va">coord</span>           <span class="co">#add the coordinates for each point</span></span>
<span><span class="co">#you now have the dataframe you need (datansd) to start analysis</span></span>
<span></span>
<span><span class="co">#NSD </span></span>
<span><span class="co">#table(datansd1$nsdid)</span></span>
<span></span>
<span><span class="co">#Now you can start modelling NSD using nlme. </span></span>
<span><span class="co">#Equations are from Bunnefeld at al (2011) A model-driven approach to quantify migration </span></span>
<span><span class="co">#patterns:individual, regional and yearly differences. </span></span>
<span><span class="co">#Journal of Animal Ecology 80:466-476</span></span>
<span></span>
<span><span class="co">#First we are going to model the data using nls, a least squares method,</span></span>
<span><span class="co">#the simplest method and first method in Bunnefeld et al. 2011 (i.e., MIGRATION)</span></span>
<span><span class="co">#that uses a double sigmoid or s-shaped function. </span></span>
<span></span>
<span><span class="co">###########################</span></span>
<span><span class="co">##</span></span>
<span><span class="co">##  MIGRATION</span></span>
<span><span class="co">##</span></span>
<span><span class="co">###########################</span></span>
<span></span>
<span><span class="va">m1</span><span class="op">&lt;-</span><span class="kw"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">nsdall</span> <span class="op">~</span>  <span class="va">asym</span> <span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">(</span><span class="va">xmidA</span><span class="op">-</span><span class="va">zerostart</span><span class="op">)</span><span class="op">/</span><span class="va">scale1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="op">(</span><span class="op">-</span><span class="va">asym</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">(</span><span class="va">xmidB</span><span class="op">-</span><span class="va">zerostart</span><span class="op">)</span><span class="op">/</span><span class="va">scale2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="co">#Equation 1 in Bunnefeld et al. 2011</span></span>
<span>start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>asym<span class="op">=</span><span class="fl">15000000</span>,xmidA<span class="op">=</span><span class="fl">200000</span>,xmidB<span class="op">=</span><span class="fl">450000</span>,scale1<span class="op">=</span><span class="fl">1000</span>,scale2<span class="op">=</span><span class="fl">1000</span><span class="op">)</span>                  </span>
<span><span class="co">#these are the starting values for each parameter of the equation </span></span>
<span>,data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">datansd1</span><span class="op">)</span><span class="op">)</span>,error<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span><span class="fl">99999</span><span class="op">)</span>   <span class="co">#this is the data</span></span>
<span><span class="co">#summary(m1)        #this will print a summary of the converged model</span></span>
<span><span class="co">#NOTE: The error function is simply to prevent the loop from crashing </span></span>
<span><span class="co">#if model does not converge</span></span>
<span></span>
<span><span class="co">###########################</span></span>
<span><span class="co">##</span></span>
<span><span class="co">##  MIXED MIGRATORY</span></span>
<span><span class="co">##</span></span>
<span><span class="co">###########################</span></span>
<span></span>
<span><span class="va">m2</span> <span class="op">&lt;-</span><span class="kw"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">nsdall</span> <span class="op">~</span>  <span class="va">asymA</span> <span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">(</span><span class="va">xmidA</span><span class="op">-</span><span class="va">zerostart</span><span class="op">)</span><span class="op">/</span><span class="va">scale1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="op">(</span><span class="op">-</span><span class="va">asymB</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">(</span><span class="va">xmidB</span><span class="op">-</span><span class="va">zerostart</span><span class="op">)</span><span class="op">/</span><span class="va">scale2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="co">#Equation 2 in Bunnefeld et al. 2011</span></span>
<span>start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>asymA<span class="op">=</span><span class="fl">15000000</span>,asymB<span class="op">=</span><span class="fl">10000000</span>, xmidA<span class="op">=</span><span class="fl">200000</span>,xmidB<span class="op">=</span><span class="fl">450000</span>,scale1<span class="op">=</span><span class="fl">1000</span>,scale2<span class="op">=</span><span class="fl">1000</span><span class="op">)</span>                  </span>
<span><span class="co">#these are the starting values for each parameter of the equation </span></span>
<span>,data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">datansd1</span><span class="op">)</span><span class="op">)</span>,error<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span><span class="fl">99999</span><span class="op">)</span>   <span class="co">#this is the data </span></span>
<span><span class="co">#summary(m2)</span></span>
<span></span>
<span><span class="co">###########################</span></span>
<span><span class="co">##</span></span>
<span><span class="co">##  DISPERSAL</span></span>
<span><span class="co">##</span></span>
<span><span class="co">###########################</span></span>
<span></span>
<span><span class="va">m3</span> <span class="op">&lt;-</span><span class="kw"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">nsdall</span> <span class="op">~</span>  <span class="va">asym</span> <span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">(</span><span class="va">xmid</span><span class="op">-</span><span class="va">zerostart</span><span class="op">)</span><span class="op">/</span><span class="va">scale</span><span class="op">)</span><span class="op">)</span>,</span>
<span>start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>asym<span class="op">=</span><span class="fl">15000000</span>,xmid<span class="op">=</span><span class="fl">200000</span>,scale<span class="op">=</span><span class="fl">1000</span><span class="op">)</span><span class="co">#Equation 3 in Bunnefeld et al. 2011                  </span></span>
<span><span class="co">#these are the starting values for each parameter of the equation </span></span>
<span>,data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">datansd1</span><span class="op">)</span><span class="op">)</span>,error<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span><span class="fl">99999</span><span class="op">)</span>   <span class="co">#this is the data</span></span>
<span><span class="co">#summary(m3)        </span></span>
<span></span>
<span><span class="co">###########################</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## HOME RANGE</span></span>
<span><span class="co">##</span></span>
<span><span class="co">###########################</span></span>
<span></span>
<span><span class="va">m4</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">nsdall</span> <span class="op">~</span> <span class="va">intercept</span>, data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">datansd1</span><span class="op">)</span>,start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  error<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span><span class="fl">99999</span><span class="op">)</span> <span class="co">#Equation 4 in Bunnefeld et al. 2011</span></span>
<span><span class="co">#where c is a constant</span></span>
<span><span class="co">#summary(m4)</span></span>
<span></span>
<span><span class="co">###########################</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## NOMADIC</span></span>
<span><span class="co">##</span></span>
<span><span class="co">###########################</span></span>
<span></span>
<span><span class="va">m5</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">nsdall</span> <span class="op">~</span> <span class="va">beta</span><span class="op">*</span><span class="va">zerostart</span>,start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>beta<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">datansd1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  error<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span><span class="fl">99999</span><span class="op">)</span> <span class="co">#Equation 5 in Bunnefeld et al. 2011 where beta is a constant </span></span>
<span><span class="co">#and t the number of days since initial start date (i.e., 1 June of each year)</span></span>
<span><span class="co">#summary(m5)</span></span>
<span></span>
<span><span class="co">#Below we are going to set up the AIC table </span></span>
<span><span class="va">ID</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">datansd</span><span class="op">$</span><span class="va">nsdid</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">LOCS</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">coords</span><span class="op">)</span></span>
<span><span class="va">MIGR</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span>,error<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">MIXM</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span>,error<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">DISP</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="va">m3</span><span class="op">)</span>,error<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">HORA</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="va">m4</span><span class="op">)</span>,error<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">NOMA</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="va">m5</span><span class="op">)</span>,error<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">AICC_1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span>,error<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span><span class="fl">99999</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">AICC_2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span>,error<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span><span class="fl">99999</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">AICC_3</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="va">m3</span><span class="op">)</span>,error<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span><span class="fl">99999</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">AICC_4</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="va">m4</span><span class="op">)</span>,error<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span><span class="fl">99999</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">AICC_5</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="va">m5</span><span class="op">)</span>,error<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span><span class="fl">99999</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">minAIC</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">AICC_1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,<span class="va">AICC_2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,<span class="va">AICC_3</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,<span class="va">AICC_4</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,<span class="va">AICC_5</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d_AICC_1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">AICC_1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="va">minAIC</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">d_AICC_2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">AICC_2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="va">minAIC</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">d_AICC_3</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">AICC_3</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="va">minAIC</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">d_AICC_4</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">AICC_4</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="va">minAIC</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">d_AICC_5</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">AICC_5</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="va">minAIC</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">LL_AICC_1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span><span class="op">*</span><span class="va">d_AICC_1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">LL_AICC_2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span><span class="op">*</span><span class="va">d_AICC_2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">LL_AICC_3</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span><span class="op">*</span><span class="va">d_AICC_3</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">LL_AICC_4</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span><span class="op">*</span><span class="va">d_AICC_4</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">LL_AICC_5</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span><span class="op">*</span><span class="va">d_AICC_5</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sumLL_AICC</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">LL_AICC_1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,<span class="va">LL_AICC_2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,<span class="va">LL_AICC_3</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,<span class="va">LL_AICC_4</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,<span class="va">LL_AICC_5</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wi_AICC_1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">LL_AICC_1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">/</span><span class="va">sumLL_AICC</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span><span class="va">wi_AICC_2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">LL_AICC_2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">/</span><span class="va">sumLL_AICC</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span><span class="va">wi_AICC_3</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">LL_AICC_3</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">/</span><span class="va">sumLL_AICC</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span><span class="va">wi_AICC_4</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">LL_AICC_4</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">/</span><span class="va">sumLL_AICC</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span><span class="va">wi_AICC_5</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">LL_AICC_5</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">/</span><span class="va">sumLL_AICC</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span></span>
<span><span class="va">filename</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">List</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span>,<span class="fl">1</span>,<span class="fl">8</span><span class="op">)</span>,<span class="st">"png"</span>,sep<span class="op">=</span><span class="st">"."</span><span class="op">)</span></span>
<span><span class="co">#NOTE:Numbers after "List[i,] need to encompass possible lengths of output name </span></span>
<span><span class="co">#(i.e., D19.txt is 6 characters)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">png</a></span><span class="op">(</span><span class="va">filename</span>,height<span class="op">=</span><span class="fl">20</span>,width<span class="op">=</span><span class="fl">30</span>,units<span class="op">=</span><span class="st">"cm"</span>,res<span class="op">=</span><span class="fl">600</span><span class="op">)</span></span>
<span><span class="co">#graphical exploration of the data will help you find sensible starting values </span></span>
<span><span class="co">#for each of the parameters asym, xmidA, xmidB, scale1 and scale2. </span></span>
<span><span class="co">#to graph nsd against time, use:</span></span>
<span><span class="fu">xyplot</span><span class="op">(</span><span class="va">nsdall</span><span class="op">~</span><span class="va">zerostart</span><span class="op">|</span><span class="va">nsdtrip</span>,data<span class="op">=</span><span class="va">datansd</span><span class="op">)</span></span>
<span><span class="co">#str(nsdtest)</span></span>
<span><span class="co">#now plot the data with the predicted curve  </span></span>
<span><span class="va">nsdplot</span> <span class="op">&lt;-</span> <span class="fu">xyplot</span><span class="op">(</span><span class="va">nsdall</span> <span class="op">~</span> <span class="va">zerostart</span><span class="op">/</span><span class="fl">3600</span>, data<span class="op">=</span><span class="va">datansd1</span>,</span>
<span>col<span class="op">=</span><span class="st">"grey"</span>,    <span class="co">#color for the observed locations</span></span>
<span>type<span class="op">=</span><span class="st">'b'</span>,      <span class="co"># 'b' shows the locations as dots, with a line connecting </span></span>
<span><span class="co">#successive locations. Can also be 'p' for just the locations, or 'l' for just </span></span>
<span><span class="co">#the line between locations</span></span>
<span>ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">'Net squared displacement '</span>,<span class="st">' '</span>, <span class="op">(</span><span class="va">km</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="co">#y axis label</span></span>
<span>xlab<span class="op">=</span><span class="st">"Hours after trip start"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">nsdplot</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#Create table of AIC values with lower AIC identifying best model</span></span>
<span><span class="va">RESULT</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">ID</span>,<span class="va">LOCS</span>,<span class="va">MIGR</span>,<span class="va">MIXM</span>,<span class="va">DISP</span>,<span class="va">HORA</span>,<span class="va">NOMA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">RESULT</span><span class="op">)</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>,<span class="st">"LOCS"</span>,<span class="st">"MIGR"</span>,<span class="st">"MIXM"</span>,<span class="st">"DISP"</span>,<span class="st">"HORA"</span>,<span class="st">"NOMA"</span><span class="op">)</span></span>
<span><span class="co">#write.table(RESULT,"OUT_NSDresults.txt",sep="\t")</span></span>
<span></span>
<span><span class="co">#Create table of raw values to calculate AICweights</span></span>
<span><span class="va">Migratory</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">ID</span>,<span class="va">AICC_1</span>,<span class="va">d_AICC_1</span>,<span class="va">LL_AICC_1</span>,<span class="va">wi_AICC_1</span><span class="op">)</span></span>
<span><span class="va">MixedMig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">ID</span>,<span class="va">AICC_2</span>,<span class="va">d_AICC_2</span>,<span class="va">LL_AICC_2</span>,<span class="va">wi_AICC_2</span><span class="op">)</span></span>
<span><span class="va">Disperser</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">ID</span>,<span class="va">AICC_3</span>,<span class="va">d_AICC_3</span>,<span class="va">LL_AICC_3</span>,<span class="va">wi_AICC_3</span><span class="op">)</span></span>
<span><span class="va">HomeRange</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">ID</span>,<span class="va">AICC_4</span>,<span class="va">d_AICC_4</span>,<span class="va">LL_AICC_4</span>,<span class="va">wi_AICC_4</span><span class="op">)</span></span>
<span><span class="va">Nomadic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">ID</span>,<span class="va">AICC_5</span>,<span class="va">d_AICC_5</span>,<span class="va">LL_AICC_5</span>,<span class="va">wi_AICC_5</span><span class="op">)</span></span>
<span><span class="va">RESULT2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">Migratory</span>,<span class="va">MixedMig</span>,<span class="va">Disperser</span>,<span class="va">HomeRange</span>,<span class="va">Nomadic</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">RESULT2</span>,<span class="st">"OUT_NSDresults.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>



</main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./RegTrajScript.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Regular Trajectories</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./TrajDynScript.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Movement Trajectory Animation</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Manual of Applied Spatial Ecology was written by W. David Walter.</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/walterASEL/Manual-of-Applied-Spatial-Ecology/edit/main/NSDscript.Rmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/walterASEL/Manual-of-Applied-Spatial-Ecology/issues/new" class="toc-action">Report an issue</a></p></div></div></div>
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


</body></html>